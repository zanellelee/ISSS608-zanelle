{
  "hash": "a1ac4894f28fbe5fb48e99f210dabfce",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Exercise 1\"\nauthor: \"Zanelle Lee Wenfang\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n    echo: true\n    eval: true\n    warning: false\n    freeze: true\n---\n\n\n\n## 1. Overview\n\n### 1.1. Background\n\nIn this exercise, Japan's heart attack occurrences are studied alongside with several possible contributing factors. Increasing numbers of heart attacks over the years make it crucial to study the situation surrounding these occurrences, and find out if there are any relationship with the variables. Insights from this analysis will be useful to act as a preventive or predictive measure.\n\n### 1.2. Objectives\n\nUsing the dataset [Heart Attack in Japan Youth vs Adult](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult), we attempt to understand the heart attack situation in Japan and gain insights surrounding the different age groups.\n\n## 2. R packages\n\nAppropriate R packages will be installed and loaded for effective data processing and transformation. The R packages used and its respective function will be displayed in the table below.\n\n| R Package | Function |\n|--------------------------|----------------------------------------------|\n| [tidyverse](http://tidyverse.org/packages/) | A collection of packages to do various types data analyses. |\n| [SmartEDA](https://cran.r-project.org/web/packages/SmartEDA/vignettes/SmartEDA.html) | For initial exploratory analysis describing the structure and relationships present in the data without lengthy R codes. |\n| [ggdist](https://mjskay.github.io/ggdist/reference/ggdist-package.html) | For visualizations of distributions and uncertainty. |\n| [ggpubr](https://rpkgs.datanovia.com/ggpubr/) | For data visualizations and customising ggplot2-based publication ready plots. |\n| [ggridges](https://www.rdocumentation.org/packages/ggridges/versions/0.5.6/topics/stat_density_ridges) | For creation and customization of ridgeline plots in ggplot2. |\n| [ggthemes](https://ggplot2.tidyverse.org/reference/ggtheme.html) | A collection of themes and scales and for tweaking of all the non-data display. |\n| [easystats](https://easystats.github.io/easystats/) | A collection of R packages to provide framework for statistical analysis and data visualization. |\n| [gtsummary](https://www.rdocumentation.org/packages/gtsummary/versions/1.2.0/topics/tbl_regression) | Takes regression model and returns formatted table of regression model results. |\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, SmartEDA, ggdist, ggpubr, ggridges, ggthemes, easystats, gtsummary)\n```\n:::\n\n\n\n## 3. Data\n\n### 3.1. Loading the data\n\nThe dataset is first loaded using *read_csv*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njapan_data <- read_csv(\"japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n### 3.2. Data overview and selection\n\nFirst, we look at the dataset to see if there are any missing or duplicated values. Using *ExpData*, there are 30,000 rows of data with no missing values nor duplicated rows. It should also be noted that there are 15 extra columns of numerical values that are meaningless as they seem to be the results of certain calculations which are not stated.\n\n::: panel-tabset\n## Summary Table 1\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n   Index           Variable_Name Variable_Type Sample_n Missing_Count\n1      1                     Age       numeric    30000             0\n2      2                  Gender     character    30000             0\n3      3                  Region     character    30000             0\n4      4         Smoking_History     character    30000             0\n5      5        Diabetes_History     character    30000             0\n6      6    Hypertension_History     character    30000             0\n7      7       Cholesterol_Level       numeric    30000             0\n8      8       Physical_Activity     character    30000             0\n9      9            Diet_Quality     character    30000             0\n10    10     Alcohol_Consumption     character    30000             0\n11    11           Stress_Levels       numeric    30000             0\n12    12                     BMI       numeric    30000             0\n13    13              Heart_Rate       numeric    30000             0\n14    14             Systolic_BP       numeric    30000             0\n15    15            Diastolic_BP       numeric    30000             0\n16    16          Family_History     character    30000             0\n17    17 Heart_Attack_Occurrence     character    30000             0\n18    18          Extra_Column_1       numeric    30000             0\n19    19          Extra_Column_2       numeric    30000             0\n20    20          Extra_Column_3       numeric    30000             0\n21    21          Extra_Column_4       numeric    30000             0\n22    22          Extra_Column_5       numeric    30000             0\n23    23          Extra_Column_6       numeric    30000             0\n24    24          Extra_Column_7       numeric    30000             0\n25    25          Extra_Column_8       numeric    30000             0\n26    26          Extra_Column_9       numeric    30000             0\n27    27         Extra_Column_10       numeric    30000             0\n28    28         Extra_Column_11       numeric    30000             0\n29    29         Extra_Column_12       numeric    30000             0\n30    30         Extra_Column_13       numeric    30000             0\n31    31         Extra_Column_14       numeric    30000             0\n32    32         Extra_Column_15       numeric    30000             0\n   Per_of_Missing No_of_distinct_values\n1               0                    62\n2               0                     2\n3               0                     2\n4               0                     2\n5               0                     2\n6               0                     2\n7               0                 30000\n8               0                     3\n9               0                     3\n10              0                     4\n11              0                 29613\n12              0                 30000\n13              0                 30000\n14              0                 30000\n15              0                 30000\n16              0                     2\n17              0                     2\n18              0                 30000\n19              0                 30000\n20              0                 30000\n21              0                 30000\n22              0                 30000\n23              0                 30000\n24              0                 30000\n25              0                 30000\n26              0                 30000\n27              0                 30000\n28              0                 30000\n29              0                 30000\n30              0                 30000\n31              0                 30000\n32              0                 30000\n```\n\n\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats1 <- ExpData(data=japan_data, type=2)\nstats1\n```\n:::\n\n\n:::\n\n::: panel-tabset\n## Summary Table 2\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n   Index           Variable_Name Variable_Type Sample_n Missing_Count\n1      1                     Age       numeric    30000             0\n2      2                  Gender     character    30000             0\n3      3                  Region     character    30000             0\n4      4         Smoking_History     character    30000             0\n5      5        Diabetes_History     character    30000             0\n6      6    Hypertension_History     character    30000             0\n7      7       Cholesterol_Level       numeric    30000             0\n8      8       Physical_Activity     character    30000             0\n9      9            Diet_Quality     character    30000             0\n10    10     Alcohol_Consumption     character    30000             0\n11    11           Stress_Levels       numeric    30000             0\n12    12                     BMI       numeric    30000             0\n13    13              Heart_Rate       numeric    30000             0\n14    14             Systolic_BP       numeric    30000             0\n15    15            Diastolic_BP       numeric    30000             0\n16    16          Family_History     character    30000             0\n17    17 Heart_Attack_Occurrence     character    30000             0\n18    18          Extra_Column_1       numeric    30000             0\n19    19          Extra_Column_2       numeric    30000             0\n20    20          Extra_Column_3       numeric    30000             0\n21    21          Extra_Column_4       numeric    30000             0\n22    22          Extra_Column_5       numeric    30000             0\n23    23          Extra_Column_6       numeric    30000             0\n24    24          Extra_Column_7       numeric    30000             0\n25    25          Extra_Column_8       numeric    30000             0\n26    26          Extra_Column_9       numeric    30000             0\n27    27         Extra_Column_10       numeric    30000             0\n28    28         Extra_Column_11       numeric    30000             0\n29    29         Extra_Column_12       numeric    30000             0\n30    30         Extra_Column_13       numeric    30000             0\n31    31         Extra_Column_14       numeric    30000             0\n32    32         Extra_Column_15       numeric    30000             0\n   Per_of_Missing No_of_distinct_values\n1               0                    62\n2               0                     2\n3               0                     2\n4               0                     2\n5               0                     2\n6               0                     2\n7               0                 30000\n8               0                     3\n9               0                     3\n10              0                     4\n11              0                 29613\n12              0                 30000\n13              0                 30000\n14              0                 30000\n15              0                 30000\n16              0                     2\n17              0                     2\n18              0                 30000\n19              0                 30000\n20              0                 30000\n21              0                 30000\n22              0                 30000\n23              0                 30000\n24              0                 30000\n25              0                 30000\n26              0                 30000\n27              0                 30000\n28              0                 30000\n29              0                 30000\n30              0                 30000\n31              0                 30000\n32              0                 30000\n```\n\n\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats2 <- ExpData(data=japan_data, type=2)\nstats2\n```\n:::\n\n\n:::\n\n### 3.3. Data preparation\n\n#### 3.3.1. Selecting desired columns\n\nAs there is no information on these columns of data, these will be filtered away from the dataset and leaving 17 columns in the new filtered dataset, *filtered_data*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_data <- select(japan_data, Age, Gender, Region, Smoking_History\n, Diabetes_History, Hypertension_History, Cholesterol_Level, Physical_Activity, Diet_Quality,\tAlcohol_Consumption,\tStress_Levels,\tBMI,\tHeart_Rate,\tSystolic_BP,\tDiastolic_BP,\tFamily_History,\tHeart_Attack_Occurrence)\n```\n:::\n\n\n\n#### 3.3.2. Adjusting variables\n\n##### 3.3.2.1. Converting variables to suitable forms\n\nSome variables are ordinal in nature and are recoded to include this information. The variables affected are *Physical_Activity*, *Diet_Quality* and *Alcohol_Consumption*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_data <- filtered_data %>% \n  mutate(Physical_Activity=(recode(Physical_Activity, \"Low\"=\"1 Low\", \"Moderate\"=\"2 Moderate\", \"High\"=\"3 High\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_data <- filtered_data %>% \n  mutate(Diet_Quality=(recode(Diet_Quality, \"Poor\"=\"1 Poor\", \"Average\"=\"2 Average\", \"Good\"=\"3 Good\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_data <- filtered_data %>% \n  mutate(Alcohol_Consumption=(recode(Alcohol_Consumption, \"None\"=\"0 None\", \"Low\"=\"1 Low\", \"Moderate\"=\"2 Moderate\", \"High\"=\"3 High\")))\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n##### 3.3.2.2. Changing variable data types\n\nLooking at the character rows, it is seen that they have fixed input and should be converted to factors using *mutate()* to reduce errors and improve efficiency. To check that this is done correctly, *glimpse()* is used.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncols <- c(\"Gender\", \"Region\", \"Physical_Activity\", \"Diet_Quality\", \"Alcohol_Consumption\", \"Smoking_History\"\n, \"Diabetes_History\", \"Hypertension_History\", \"Family_History\",\t\"Heart_Attack_Occurrence\")\nfiltered_data <- filtered_data %>%\n  mutate(across(cols, as.factor))\n\nglimpse(filtered_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 17\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <fct> Male, Male, Male, Female, Female, Female, Male…\n$ Region                  <fct> Urban, Urban, Rural, Urban, Rural, Rural, Urba…\n$ Smoking_History         <fct> Yes, No, Yes, No, No, No, No, Yes, No, No, No,…\n$ Diabetes_History        <fct> No, No, No, No, No, No, Yes, No, No, No, No, N…\n$ Hypertension_History    <fct> No, No, No, No, No, No, Yes, No, Yes, No, Yes,…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <fct> 2 Moderate, 1 Low, 1 Low, 2 Moderate, 3 High, …\n$ Diet_Quality            <fct> 1 Poor, 3 Good, 2 Average, 3 Good, 3 Good, 3 G…\n$ Alcohol_Consumption     <fct> 1 Low, 1 Low, 2 Moderate, 3 High, 3 High, 3 Hi…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <fct> No, Yes, No, No, No, No, No, No, No, Yes, Yes,…\n$ Heart_Attack_Occurrence <fct> No, No, No, No, No, No, No, No, Yes, No, No, N…\n```\n\n\n:::\n:::\n\n\n\n##### 3.3.2.3. Binning *Age* into Age Groups\n\nTo be able to gain better insights from the dataset, it was decided that *Age* should be binned into 4 separate bins - Youth, Adult, Middle-aged adult and Senior Citizen. The binned age will be stored under a new variable, *Age_Group*. The differences between the various age groups might be more visible than if it was kept as a continuous variable.\n\n::: {.callout-tip title=\"Age Classification\"}\nFor this analysis, the age classification would be as such:\n\n|                   |                   |\n|-------------------|-------------------|\n| Youth             | \\<= 25 years old  |\n| Adult             | 26 - 44 years old |\n| Middle-aged adult | 45 - 49 years old |\n| Senior Citizen    | \\>= 60 years old  |\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinned_data <- filtered_data %>% mutate(Age_Group = cut(Age, breaks=c(0, 24, 44, 59, 80)))\n\nbinned_data <- binned_data %>% \n  relocate(Age_Group, .after = Age)\n\nbinned_data <- binned_data %>% \n  mutate(Age_Group=(recode(Age_Group, \"(0,24]\"=\"Youth\", \"(24,44]\"=\"Adult\", \"(44,59]\"=\"Middle-aged adult\", \"(59,80]\"=\"Senior Citizen\")))\nglimpse(binned_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 18\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Age_Group               <fct> Middle-aged adult, Senior Citizen, Middle-aged…\n$ Gender                  <fct> Male, Male, Male, Female, Female, Female, Male…\n$ Region                  <fct> Urban, Urban, Rural, Urban, Rural, Rural, Urba…\n$ Smoking_History         <fct> Yes, No, Yes, No, No, No, No, Yes, No, No, No,…\n$ Diabetes_History        <fct> No, No, No, No, No, No, Yes, No, No, No, No, N…\n$ Hypertension_History    <fct> No, No, No, No, No, No, Yes, No, Yes, No, Yes,…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <fct> 2 Moderate, 1 Low, 1 Low, 2 Moderate, 3 High, …\n$ Diet_Quality            <fct> 1 Poor, 3 Good, 2 Average, 3 Good, 3 Good, 3 G…\n$ Alcohol_Consumption     <fct> 1 Low, 1 Low, 2 Moderate, 3 High, 3 High, 3 Hi…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <fct> No, Yes, No, No, No, No, No, No, No, Yes, Yes,…\n$ Heart_Attack_Occurrence <fct> No, No, No, No, No, No, No, No, Yes, No, No, N…\n```\n\n\n:::\n:::\n\n\n\n::: callout-caution\nIt should be noted that several columns have measurements that consist of seemingly impossible values.\n\nThe *BMI* column consists of single digit values. However, the [World Health Organisation](https://apps.who.int/nutrition/landscape/help.aspx?menu=0&helpid=420#:~:text=BMI%20%3C17.0%3A%20moderate%20and%20severe,BMI%20%E2%89%A525.0%3A%20overweight) states that BMI values of \\<17.0 indicates moderate and severe thinness in adult populations and BMI \\<16.0 is known to be associated with a markedly increased risk for ill-health, poor physical performance, lethargy and even death; thus making this cut-off point to be a valid extreme limit.\n\nThe [minimum systolic blood pressure and diastolic blood pressure](https://www.ncbi.nlm.nih.gov/books/NBK268/#:~:text=The%20minimum%20acceptable%20blood%20pressure,be%20great%20variation%20between%20patients.) is also stated to be 90 mm Hg systolic and 60 mm Hg diastolic while the lowest values in the dataset go as low as 56.2 mm Hg under *Systolic_BP* and 40.0 mm Hg (3s.f.) under *Diastolic_BP*.\n\nHowever, as the dataset did not clarify the units used as well as calculation methods to obtain these values. Thus, these values are not removed from the dataset but this discrepency should be taken into account and further investigation should be made to ensure these variables conform to the commonly understood version.\n:::\n\n## 4. Data exploration and analysis\n\n### 4.1. Exploratory Data Analysis\n\n#### 4.1.1. Grouping similar variables\n\nFor more efficient analysis of the dataset, it is decided that the variables should be split to **Uncontrollable**, **Lifestyle** and **Measurements**. The way that it is split is as per follows:\n\n| Uncontrollable | Lifestyle           | Measurements         |\n|----------------|---------------------|----------------------|\n| Gender         | Smoking_History     | Diabetes_History     |\n| Region         | Physical_Activity   | Hypertension_History |\n| Family_History | Diet_Quality        | Cholesterol_Level    |\n|                | Alcohol_Consumption | BMI                  |\n|                | Stress_Levels       | Heart_Rate           |\n|                |                     | Systolic_BP          |\n|                |                     | Diastolic_BP         |\n\n*Age* and *Heart_Attack_Occurrences* are not included in the table above as they are considered the target variables in this data. However, if they were to be placed, they would fall under **Uncontrollable**.\n\n#### 4.1.2. Age vs Heart Attack Occurrence\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=binned_data, aes(x=Age_Group, fill=Heart_Attack_Occurrence)) +\n  geom_bar(width=.8, alpha = 0.7, position=\"dodge\") +\n  ggtitle(\" \") + xlab(\"Age Group\") + labs(fill=\"Heart Attack Occurrence\")\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-Home_Exercise_1_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\nThe percentages of heart attack occurrences in each age group can also be seen below.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n           Youth            Adult Middle-age adult   Senior Citizen \n        9.126506        10.151254         9.894589         9.851760 \n```\n\n\n:::\n:::\n\n\n\nYouths are the smallest group in this dataset but have a decent group size of \\>2500, reducing the likelihood of skewed data. The percentage of people with heart attack occurrences are also relatively similar throughout the different age groups, ranging around 9-10%. *Adults* have the highest percentage perhaps more can be done to investigate the factors that might be contributing to this statistic.\n\n#### 4.1.3. Uncontrollable VS Heart Attack Occurrence\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nu1 <- ggplot(data=binned_data, aes(y=Heart_Attack_Occurrence, x=Age, fill=Gender)) +\n  geom_violin(alpha=0.3, position=\"identity\") +\n  ylab(\"Heart Attack Occurrence\") + xlab(\"Age\")\n\nu2 <- ggplot(data=binned_data, aes(y=Heart_Attack_Occurrence, x=Age, fill=Region)) +\n  geom_violin(alpha=0.3, position=\"identity\") +\n  ylab(\"Heart Attack Occurrence\") + xlab(\"Age\")\n\nu3 <- ggplot(data=binned_data, aes(y=Heart_Attack_Occurrence, x=Age, fill=Family_History)) +\n  geom_violin(alpha=0.3, position=\"identity\") +\n  ylab(\"Heart Attack Occurrence\") + xlab(\"Age\") + labs(fill=\"Family History\") + \n  theme(legend.text=element_text(size=8), legend.title=element_text(size=8), legend.key.size = unit(.5,'cm'))\n\nfigureu <- ggarrange(u1 + rremove(\"xlab\"), u2 + rremove(\"xlab\"), u3,\n                    ncol = 1, nrow = 3)\nfigureu\n```\n:::\n\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](Take-Home_Exercise_1_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\nLooking at the violin plot, the most noticeable feature would be that across the 3 variables, there is higher heart attack occurrence amongst those who are around the age range of 30-45 years old (falling under the *Adult* age group) and this is consistent with the information that was previously obtained.\n\nNext, it is noticed that younger rural women and older urban men were more susceptible to heart attacks. This might be due to differing family duties and working practices between the people in the rural and urban areas.\n\nInterestingly, family history does not seem to significantly affect the chances of a heart attack occurrence, contrary to this [study](https://www.nejm.org/doi/full/10.1056/NEJMoa1605086) of increased risks. Little deviation is seen between the two groups.\n\nThe data remain relatively constant and similar for the group that experienced no heart attack occurrences regardless of the variable being measured.\n\n#### 4.1.4. Lifestyle VS Heart Attack Occurrence\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#smoking l1\nl1 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Smoking_History)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") + labs(fill=\"Smoking History\")\n\n#physical activity l2\nl2 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Physical_Activity)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") + labs(fill=\"Level of \\nPhysical Activity\")\n\n#diet quality l3\nl3 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Diet_Quality)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") + labs(fill=\"Level of \\nDiet QUality\")\n\n#alcohol consumption l4\nl4 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Alcohol_Consumption)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") + labs(fill=\"Level of \\nAlcohol Consumption\")\n\n#stress levels l5\nl5 <- ggplot(binned_data,\n       aes(x = Stress_Levels, \n           y = Age_Group, \n           fill = factor(stat(quantile))\n           )) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"Stress Levels\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) +\n  theme_ridges()\n\nfigurel <- ggarrange(l1, l2, l3, l4, l5,\n                    ncol = 1, nrow = 5)\nfigurel\n```\n:::\n\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](Take-Home_Exercise_1_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=1536}\n:::\n:::\n\n\n\nOverall, there are no distinct differences between the stacked bar plots of the group with heart attack occurrences and the group without. There are slight differences such as:\n\n**Smoking History**: The group that experienced a heart attack occurrence might have a slightly higher proportion of people with a smoking history in the *Youth* and *Middle-aged adult* age groups.\n\n**Physical Activity**: The *Middle-aged adult* age group that has experienced a heart attack seem to have a smaller proportion of people with low physical activity and a higher proportion those with high physical activity, which may seem unusual.\n\nFor the ridgeline plots, the *Adult* and *Senior Citizen* age groups have visibly higher stress levels in the group that has had a heart attack. The peaks of the plots are also of higher stress levels in general, as compared to the group that did not experience a heart attack occurrence. There might be some relationship between *Stress_Levels* and *Heart_Attack_Occurrence*.\n\n#### 4.1.5. Measurements VS Heart Attack Occurrence\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#diabetes m1\nm1 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Diabetes_History)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") +\n  labs(fill=\"Diabetes History\")\n\n#hypertension m2\nm2 <- ggplot(data=binned_data, aes(x=Age_Group, fill=Hypertension_History)) +\n  geom_bar(alpha = 0.6, width= 0.6, stat=\"count\", position=\"fill\") + \n  scale_y_continuous(labels = scales::percent) +\n  facet_wrap(~Heart_Attack_Occurrence) + rremove(\"xlab\") + rremove(\"ylab\") +\n  labs(fill=\"Hypertension History\")\n\n#cholesterol m3\nm3 <- ggplot(binned_data,\n       aes(x = Cholesterol_Level, y = Age_Group, \n           fill = factor(stat(quantile)))) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"Cholesterol Level\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) + theme_ridges()\n\n#BMI m4\nm4 <- ggplot(binned_data,\n       aes(x = BMI, y = Age_Group, \n           fill = factor(stat(quantile)))) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"BMI\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) + theme_ridges()\n\n#heartrate m5\nm5 <- ggplot(binned_data,\n       aes(x = Heart_Rate, y = Age_Group, \n           fill = factor(stat(quantile)))) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"Heart Rate\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) + theme_ridges()\n\n#systolicBP m6\nm6 <- ggplot(binned_data,\n       aes(x = Systolic_BP, y = Age_Group, \n           fill = factor(stat(quantile)))) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"Systolic BP\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) + theme_ridges()\n\n#diastolicBP m7\nm7 <- ggplot(binned_data,\n       aes(x = Diastolic_BP, y = Age_Group, \n           fill = factor(stat(quantile)))) +\n  stat_density_ridges(\n    geom = \"density_ridges_gradient\",\n    calc_ecdf = TRUE, \n    quantiles = 4,\n    quantile_lines = TRUE) +\n  scale_fill_viridis_d(name = \"Quartiles\") + xlab(\"Diastolic BP\") + ylab(\"Age Group\") +\n  facet_wrap(~Heart_Attack_Occurrence) + theme_ridges()\n\nfigurem <- ggarrange(m1, m2, m3, m4, m5, m6, m7,\n                    ncol = 1, nrow = 7)\nfigurem\n```\n:::\n\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](Take-Home_Exercise_1_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=1536}\n:::\n:::\n\n\n\nThe stacked bar plots do not show significant differences, except that there is a higher proportion of people with a history of diabetes in the *Youth* age group with a heart attack occurrence. Otherwise, the plots are relatively similar between the two groups.\n\nFor the ridgeline plots, there are minor differences:\n\n**Cholesterol Level**: The group with heart attack occurrence surprisingly have lower cholesterol levels (except the \\*Adult\\* age group) than the group without.\n\n**BMI**: *Youth* and *Senior Citizen* in the group with heart attack occurrence might have lower BMI than their peers in the other group.\n\nThe rest of the plots do not have notable differences, or the group with a heart attack occurrence might have slightly higher readings than their peers in the group that do not have heart attack occurrences.\n\n### 4.2. Regression and Correlation\n\n#### 4.2.1. One Hot Encoding\n\nAs there are a few categorical data, they are converted to 0 and 1. These variables include *Gender*, *Region*, *Smoking_History*, *Diabetes_History*, *Hypertension_History*, *Family_History*, *Heart_Attack_Occurrence*. They are also converted to numeric values.\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_data <- filtered_data %>% \n  mutate(Gender=(recode(Gender, \"Female\"=\"0\", \"Male\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Region=(recode(Region, \"Rural\"=\"0\", \"Urban\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Smoking_History=(recode(Smoking_History, \"No\"=\"0\", \"Yes\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Diabetes_History=(recode(Diabetes_History, \"No\"=\"0\", \"Yes\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Hypertension_History=(recode(Hypertension_History, \"No\"=\"0\", \"Yes\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Family_History=(recode(Family_History, \"No\"=\"0\", \"Yes\"=\"1\")))\n\nfiltered_data <- filtered_data %>% \n  mutate(Heart_Attack_Occurrence=(recode(Heart_Attack_Occurrence, \"No\"=\"0\", \"Yes\"=\"1\")))\n\ncols1 <- c(\"Gender\", \"Region\", \"Smoking_History\"\n, \"Diabetes_History\", \"Hypertension_History\", \"Family_History\",\t\"Heart_Attack_Occurrence\")\nfiltered_data <- filtered_data %>%\n  mutate(across(cols1, as.numeric))\n\nglimpse(filtered_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 17\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <dbl> 2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 2, 1, 1, 1, 1, 2…\n$ Region                  <dbl> 2, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2…\n$ Smoking_History         <dbl> 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1…\n$ Diabetes_History        <dbl> 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 2…\n$ Hypertension_History    <dbl> 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <fct> 2 Moderate, 1 Low, 1 Low, 2 Moderate, 3 High, …\n$ Diet_Quality            <fct> 1 Poor, 3 Good, 2 Average, 3 Good, 3 Good, 3 G…\n$ Alcohol_Consumption     <fct> 1 Low, 1 Low, 2 Moderate, 3 High, 3 High, 3 Hi…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <dbl> 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 2, 1…\n$ Heart_Attack_Occurrence <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1…\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 4.2.2. Regression Model\n\n*glm()* is used to fit all the variables with *Heart_Attack_Occurrence* as a dependent variable.\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- glm(Heart_Attack_Occurrence ~ Age + Gender + Region + Smoking_History + Diabetes_History + Hypertension_History + Cholesterol_Level + Stress_Levels + BMI + Heart_Rate + Systolic_BP + Diastolic_BP + Family_History, data=filtered_data)\n\nmodel\nsummary(model)\ntbl_regression(model, intercept=TRUE)\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:  glm(formula = Heart_Attack_Occurrence ~ Age + Gender + Region + \n    Smoking_History + Diabetes_History + Hypertension_History + \n    Cholesterol_Level + Stress_Levels + BMI + Heart_Rate + Systolic_BP + \n    Diastolic_BP + Family_History, data = filtered_data)\n\nCoefficients:\n         (Intercept)                   Age                Gender  \n           1.080e+00             9.129e-05             6.305e-03  \n              Region       Smoking_History      Diabetes_History  \n          -1.581e-04             4.556e-03             5.606e-03  \nHypertension_History     Cholesterol_Level         Stress_Levels  \n           2.656e-03            -1.173e-05            -1.824e-03  \n                 BMI            Heart_Rate           Systolic_BP  \n          -3.067e-04             1.657e-04            -1.065e-04  \n        Diastolic_BP        Family_History  \n           1.367e-04            -8.016e-04  \n\nDegrees of Freedom: 29999 Total (i.e. Null);  29986 Residual\nNull Deviance:\t    2671 \nResidual Deviance: 2670 \tAIC: 12590\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Heart_Attack_Occurrence ~ Age + Gender + Region + \n    Smoking_History + Diabetes_History + Hypertension_History + \n    Cholesterol_Level + Stress_Levels + BMI + Heart_Rate + Systolic_BP + \n    Diastolic_BP + Family_History, data = filtered_data)\n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           1.080e+00  3.060e-02  35.277   <2e-16 ***\nAge                   9.129e-05  9.627e-05   0.948   0.3430    \nGender                6.305e-03  3.446e-03   1.830   0.0673 .  \nRegion               -1.580e-04  3.768e-03  -0.042   0.9665    \nSmoking_History       4.556e-03  3.760e-03   1.212   0.2257    \nDiabetes_History      5.606e-03  4.282e-03   1.309   0.1905    \nHypertension_History  2.656e-03  3.988e-03   0.666   0.5054    \nCholesterol_Level    -1.173e-05  5.749e-05  -0.204   0.8384    \nStress_Levels        -1.824e-03  8.716e-04  -2.093   0.0364 *  \nBMI                  -3.067e-04  3.445e-04  -0.890   0.3733    \nHeart_Rate            1.657e-04  1.720e-04   0.963   0.3353    \nSystolic_BP          -1.065e-04  1.148e-04  -0.927   0.3537    \nDiastolic_BP          1.367e-04  1.725e-04   0.793   0.4280    \nFamily_History       -8.016e-04  3.768e-03  -0.213   0.8315    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.08903419)\n\n    Null deviance: 2671.2  on 29999  degrees of freedom\nResidual deviance: 2669.8  on 29986  degrees of freedom\nAIC: 12590\n\nNumber of Fisher Scoring iterations: 2\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vubljtolzw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vubljtolzw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vubljtolzw thead, #vubljtolzw tbody, #vubljtolzw tfoot, #vubljtolzw tr, #vubljtolzw td, #vubljtolzw th {\n  border-style: none;\n}\n\n#vubljtolzw p {\n  margin: 0;\n  padding: 0;\n}\n\n#vubljtolzw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vubljtolzw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vubljtolzw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vubljtolzw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vubljtolzw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vubljtolzw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vubljtolzw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vubljtolzw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vubljtolzw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vubljtolzw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vubljtolzw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vubljtolzw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vubljtolzw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vubljtolzw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vubljtolzw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vubljtolzw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vubljtolzw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vubljtolzw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vubljtolzw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vubljtolzw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vubljtolzw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vubljtolzw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vubljtolzw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vubljtolzw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vubljtolzw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vubljtolzw .gt_left {\n  text-align: left;\n}\n\n#vubljtolzw .gt_center {\n  text-align: center;\n}\n\n#vubljtolzw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vubljtolzw .gt_font_normal {\n  font-weight: normal;\n}\n\n#vubljtolzw .gt_font_bold {\n  font-weight: bold;\n}\n\n#vubljtolzw .gt_font_italic {\n  font-style: italic;\n}\n\n#vubljtolzw .gt_super {\n  font-size: 65%;\n}\n\n#vubljtolzw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vubljtolzw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vubljtolzw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vubljtolzw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vubljtolzw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vubljtolzw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vubljtolzw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#vubljtolzw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#vubljtolzw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"PHN0cm9uZz5CZXRhPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Beta</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4=\"><span class='gt_from_md'><strong>95% CI</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1.1</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1.0, 1.1</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Age</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.3</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Gender</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.01</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.067</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Region</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">-0.01, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">>0.9</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Smoking_History</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.2</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Diabetes_History</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.01</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.2</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Hypertension_History</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">-0.01, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.5</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Cholesterol_Level</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.8</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Stress_Levels</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.036</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">BMI</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.4</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Heart_Rate</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.3</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Systolic_BP</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.4</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Diastolic_BP</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0.00, 0.00</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.4</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Family_History</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">-0.01, 0.01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.8</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"Q0kgPSBDb25maWRlbmNlIEludGVydmFs\"><span class='gt_from_md'>CI = Confidence Interval</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nThe model only has a slightly lower Residual Deviance from the Null Deviance, accompanied by a high AIC value of 12590, indicating that the model's predictive power might be weak, and not a great model fit.\n\nMost coefficients are very close to zero, indicating that the effects are minimal. However, it is suprising to note that *Stress_Levels*, *Cholesterol_Level* and *Family_History* have negative coefficients, meaning that they slightly reduce the likelihood of a heart attack. *Age*, *Smoking_History* and *Diabetes_History* increase the risk but minimally.\n\n#### 4.2.3. Checking for collinearity\n\n::: {.callout-note collapse=\"true\" title=\"See codes\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_collinearity(model)\n```\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n                 Term  VIF       VIF 95% CI Increased SE Tolerance\n                  Age 1.00 [1.00,  1376.01]         1.00      1.00\n               Gender 1.00 [1.00, 5.31e+06]         1.00      1.00\n               Region 1.00 [1.00, 3.27e+06]         1.00      1.00\n      Smoking_History 1.00 [1.00,      Inf]         1.00      1.00\n     Diabetes_History 1.00 [1.00, 63918.13]         1.00      1.00\n Hypertension_History 1.00 [1.00, 3.71e+06]         1.00      1.00\n    Cholesterol_Level 1.00 [1.00, 1.09e+10]         1.00      1.00\n        Stress_Levels 1.00 [1.00, 1.99e+10]         1.00      1.00\n                  BMI 1.00 [1.00, 9.53e+07]         1.00      1.00\n           Heart_Rate 1.00 [1.00, 5.00e+05]         1.00      1.00\n          Systolic_BP 1.00 [1.00, 1.76e+07]         1.00      1.00\n         Diastolic_BP 1.00 [1.00, 2.66e+09]         1.00      1.00\n       Family_History 1.00 [1.00, 3.69e+07]         1.00      1.00\n Tolerance 95% CI\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n     [0.00, 1.00]\n```\n\n\n:::\n:::\n\n\n\nLow VIF (Variance Inflation Factor) and high tolerance indicate that there are no collinearity issues and that all the independent variables are uncorrelated. However, this suggests that there are potential data issues such as sparse data or poor scaling.\n\n## 5. Summary\n\nThere are no distinct variables or factors directly correlated or contributing to heart attack occurrences. The model created is also not the best fit or an accurate predictive model. It is noted that the data might require further cleaning up that led to the several unusual insights gained. More data collection and analysis could be done in the future to better understand the heart attack situation in Japan.\n",
    "supporting": [
      "Take-Home_Exercise_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}